import{A as f,a as m,s as i}from"./constants-DQWCF818.js";import{s as p}from"./suggestTags-B1X2dEtq.js";import{s as g}from"./logout-Dt4pnz2u.js";import{a as y}from"./authGuard-C2GFzsuy.js";async function h({title:r,body:e,tags:o,media:a}){const s=localStorage.getItem("token"),n={title:r,body:e,tags:o,media:a},c={"Content-Type":"application/json",Authorization:`Bearer ${s}`,"X-Noroff-API-Key":m};try{const t=await fetch(f,{method:"POST",headers:c,body:JSON.stringify(n)});if(t.ok){const{data:d}=await t.json();return d}const u=await t.json();throw new Error(u.message||"An unexpected error occurred while creating the post. Please try again.")}catch(t){throw console.error("Error creating post:",t),t}}g();async function w(r){r.preventDefault();const{title:e,body:o,mediaUrl:a}=r.target.elements,s=p(e.value),n={url:a.value,alt:e.value},c={title:e.value,body:o.value,tags:s,media:n};if(o.value.length>280){i("The body of the post cannot exceed 280 characters.","error");return}try{const t=await h(c);i("Success! You just created a new post","success"),r.target.reset(),setTimeout(()=>window.location.pathname="/profile/",2e3)}catch(t){console.error("Error:",t),i(`Failed to create new post. Please try again. Error: ${t.message}`,"error")}}y();const l=document.getElementById("create-post-form");l.addEventListener("submit",async function(r){const e=l.querySelector("fieldset"),o=l.querySelector("button"),a=o.textContent;e.disabled=!0,o.textContent="Creating post...";try{await w(r)}catch(s){console.error("Error:",s)}finally{e.disabled=!1,o.textContent=a}});
