import{a as y}from"./authGuard-C2GFzsuy.js";import{s as x}from"./logout-Dt4pnz2u.js";import{r as w}from"./read-DMiUFT0z.js";import{s as b}from"./constants-DQWCF818.js";import{s as B,h as S}from"./skeletonLoader-C84aKAOy.js";y();x();const T=12;let r=1;const E=50;let s={isFirstPage:!0,isLastPage:!0,currentPage:1,previousPage:null,nextPage:null,pageCount:1,totalCount:0};const g=document.getElementById("prevBtn"),p=document.getElementById("nextBtn"),f=document.getElementById("pageInfo");function k(t){s=t||s;const e=(t==null?void 0:t.currentPage)??r,n=(t==null?void 0:t.pageCount)??1,o=Math.min(n,E);g&&(g.disabled=e<=1||(t==null?void 0:t.previousPage)==null||!!(t!=null&&t.isFirstPage)),p&&(p.disabled=e>=o||(t==null?void 0:t.nextPage)==null||!!(t!=null&&t.isLastPage)),f&&(f.textContent=`${e}/${o}`)}function M(){const t=document.querySelector("#all-posts");t&&typeof t.scrollIntoView=="function"?t.scrollIntoView({behavior:"smooth",block:"start"}):window.scrollTo({top:0,behavior:"smooth"})}function L(t,e=""){const n=(s==null?void 0:s.pageCount)??Number.POSITIVE_INFINITY,o=Math.min(n,E);return r=Math.min(Math.max(1,t),o),M(),P(e)}async function P(t=""){const e=document.querySelector("#all-posts");try{B();const{data:n,meta:o}=await w(T,r),c=t?n.filter(i=>(i.title||"").toLowerCase().includes(t.toLowerCase())):n;if(e.innerHTML="",c.forEach(i=>{const l=A(i);e.appendChild(l)}),c.length===0){const i=document.createElement("p");i.textContent="No posts found. Try searching for something else!",e.appendChild(i)}o&&k(o)}catch(n){b("Error fetching posts: "+n.message,"error")}finally{S()}}function A(t){var h;const e=document.createElement("div");e.classList.add("post");const n=document.createElement("img");n.src=((h=t.media)==null?void 0:h.url)||"/images/default-post-image.png",n.alt=t.title||"Post Image",n.classList.add("post-image"),e.appendChild(n);const o=document.createElement("h3");o.textContent=t.title,o.classList.add("post-h3"),e.appendChild(o);const c=document.createElement("p"),i=t.body?t.body.slice(0,100)+"...":"No content available";c.textContent=i,c.classList.add("post-body"),e.appendChild(c);const l=document.createElement("p"),v=new Date(t.created);l.textContent=`Posted ${v.toLocaleDateString()}`,l.classList.add("post-date"),e.appendChild(l);const u=document.createElement("div");if(u.classList.add("snippet-post-tags"),Array.isArray(t.tags)&&t.tags.length>0)t.tags.forEach(d=>{const m=document.createElement("span");m.textContent=d,m.classList.add("snippet-post-tag-item"),u.appendChild(m)});else{const d=document.createElement("span");d.textContent="No tags",d.classList.add("snippet-post-no-tags"),u.appendChild(d)}return e.appendChild(u),e.addEventListener("click",()=>{window.location.href=`/post/?id=${t.id}`}),e}const C=document.getElementById("search-button"),a=document.getElementById("search-input");function I(){const t=((a==null?void 0:a.value)||"").trim();return r=1,P(t||"")}C&&C.addEventListener("click",I);g&&g.addEventListener("click",()=>{const t=(s==null?void 0:s.previousPage)??r-1;L(t,((a==null?void 0:a.value)||"").trim())});p&&p.addEventListener("click",()=>{const t=(s==null?void 0:s.nextPage)??r+1;L(t,((a==null?void 0:a.value)||"").trim())});P();
